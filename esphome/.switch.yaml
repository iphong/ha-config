esphome:
  name: $name
  board: modwifi
  platform: ESP8266
  build_path: build/$name
  esp8266_restore_from_flash: true
  platformio_options:
    upload_speed: 921600

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  reboot_timeout: 0s
  ap:
    ssid: $name
    password: !secret wifi_password
    ap_timeout: 0s

ota:
  password: !secret wifi_password

api:
  reboot_timeout: 0s

logger:
  baud_rate: 0

web_server:

remote_transmitter:
  pin: 1
  carrier_duty_percent: 100%

status_led:
  pin:
    number: 16
    inverted: true

output:
  
  - platform: esp8266_pwm
    id: output_1
    frequency: 100hz
    pin: 4
  
  - platform: esp8266_pwm
    id: output_2
    frequency: 100hz
    pin: 15
  
  - platform: esp8266_pwm
    id: output_3
    frequency: 100hz
    pin: 13
    
light:
  
  - platform: monochromatic
    id: light_1
    output: output_1
    default_transition_length: 0s

  - platform: monochromatic
    id: light_2
    output: output_2
    default_transition_length: 0s

  - platform: monochromatic
    id: light_3
    output: output_3
    default_transition_length: 0s
    
binary_sensor:
  
  - platform: gpio
    id: input_1
    pin:
      number: 14
      inverted: true
    on_release:
      - light.turn_off: light_1
    on_press:
      then:
        - light.turn_on:
            id: light_1
            transition_length: 0s
        - remote_transmitter.transmit_panasonic:
            address: 0x1FEF
            command: 0x1F3E065F

  - platform: gpio
    id: input_2
    pin:
      number: 5
      inverted: true
    on_release:
      - light.turn_off: light_2
    on_press:
      then:
        - light.turn_on:
            id: light_2
            transition_length: 0s
        - if:
            condition:
              api.connected:
            then:
              - homeassistant.service:
                  service: homeassistant.toggle
                  data:
                    entity_id: $button2_entity
            else:
              - remote_transmitter.transmit_rc_switch_raw:
                  code: $button2_code
                  protocol: 2
                  repeat:
                    times: 3
                    wait_time: 200ms

  - platform: gpio
    id: input_3
    pin:
      number: 12
      inverted: true
    on_release:
      - light.turn_off: light_3
    on_press:
      then:
        - light.turn_on:
            id: light_3
            transition_length: 0s
        - remote_transmitter.transmit_rc_switch_type_c:
            family: 'C'
            group: 3
            device: 1
            state: off
            protocol: 1
